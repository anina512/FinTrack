<app-side-nav></app-side-nav>
<div class="content">
<div class="dashboard">
    <div class="content">
      <div class="main-section">
        <!-- Left Column -->
        <div class="left-column">
          <!-- Stats Cards -->
          <div class="stats-section">
            <!-- Income Card -->
            <div class="card income-card">
              <h2><i class="fas fa-wallet"></i> Income</h2>
              <div class="chart-container doughnut-chart">
                <canvas id="incomeChart"></canvas>
              </div>
              <div class="card-footer">
                <p>Total Income: ${{ income.toLocaleString() }}</p>
                <small>{{ incomeComparisonText }}</small>
              </div>
              <div class="button-container row-buttons">
                <button class="btn add-income" (click)="openIncomeModal()">
                  <i class="fas fa-plus-circle"></i>
                </button>
                <button class="btn view-income" (click)="viewIncomeDetails()">
                  <i class="fas fa-eye"></i>
                </button>
              </div>
            </div>
  
            <!-- Expenses Card -->
            <div class="card expenses-card">
              <h2><i class="fas fa-receipt"></i> Expenses</h2>
              <div class="chart-container doughnut-chart">
                <canvas id="expensesChart"></canvas>
              </div>
              <div class="card-footer">
                <p>Total Expense: ${{ expenses.toLocaleString() }}</p>
                <small>{{expenseComparisonText}}</small>
              </div>
              <div class="button-container row-buttons">
                <button class="btn add-expense" (click)="openExpenseModal()">
                  <i class="fas  fa-plus-circle"></i>
                </button>
                <button class="btn view-expense" (click)="viewExpenseDetails()">
                  <i class="fas fa-eye"></i>
                </button>
              </div>
            </div>
  
            <!-- Savings Card -->
            <div class="card savings-card">
              <h2><i class="fas fa-piggy-bank"></i> Budget</h2>
              <div class="chart-container doughnut-chart">
                <canvas id="savingsChart"></canvas>
              </div>
              <div class="card-footer">
                <p><strong>Used:</strong> {{ currentMonthExpenses | currency }}</p>
                <p><strong>Remaining:</strong> {{ (currentMonthBudget - currentMonthExpenses) | currency }}</p>
              </div>
              <div class="button-container row-buttons">
                <button class="btn add-budget" (click)="openBudgetModal()">
                  <i class="fas  fa-plus-circle"></i>
                </button>
                <button class="btn view-budget" (click)="viewBudgetDetails()">
                  <i class="fas fa-eye"></i>
                </button>
              </div>
            </div>
          </div>
  
          <!-- Weekly Expenses -->
          <div class="bottom-section">
            <div class="card weekly-expenses-card">
              <h2><i class="fas fa-chart-line"></i> Weekly Expenses</h2>
              <div class="chart-container bar-chart">
                <canvas id="weeklyExpensesChart"></canvas>
              </div>
            </div>
          </div>
        </div>
  
        <!-- Right Column -->
        <div class="right-column">
          <div class="card upcoming-payments">
            <h2><i class="fas fa-calendar-alt"></i> Upcoming Payments</h2>
            <ul>
              <li *ngFor="let payment of upcomingPayments">
                <strong>{{ payment.name }}</strong>${{ payment.amount }}  
                <br />
                <span>{{ payment.description }}</span>  
                <br />
                <small>Due: {{ payment.date | date:'MM/dd/yyyy' }}</small>
                <button class="paid-button" (click)="markAsPaid(payment)">
                  <i class="fas fa-check"></i>  
              </button>
              </li>
            </ul>
          </div>

          <div class="card recent-activities">
            <h3>Recent Activities</h3>
            
            <!-- Recent Income -->
            <div class="recent-income">
              <h4>Income Added</h4>
              <ul>
                <li *ngFor="let income of allIncomes | slice:0:3">
                  {{ income.date | date:'shortDate' }} - {{ income.category }}: ${{ income.amount }}
                </li>
              </ul>
            </div>
          
            <!-- Recent Expenses -->
            <div class="recent-expenses">
              <h4>Expenses Added</h4>
              <ul>
                <li *ngFor="let expense of allExpenses | slice:0:3">
                  {{ expense.date | date:'shortDate' }} - {{ expense.category }}: ${{ expense.amount }}
                </li>
              </ul>
            </div>
          
            <!-- View All Button -->
            <button (click)="openActivitiesModal()" class="btn btn-primary">View All Activities</button>
          </div>         
          
        </div>
        <app-expense 
        *ngIf="showExpenseModal"
        [mode]="expenseMode"
        (closeModal)="closeExpenseModal()"
        (expenseSaved)="onExpenseSaved($event)">
      </app-expense>
        <app-income 
          *ngIf="showIncomeModal"
          [mode]="incomeMode"
          (closeModal)="closeIncomeModal()"
          (incomeSaved)="onIncomeSaved($event)">
        </app-income>
        <app-budget 
          *ngIf="showBudgetModal"
          [mode]="budgetMode"
          (closeModal)="closeBudgetModal()"
          (budgetSaved)="onBudgetSaved($event)">
        </app-budget>
        <app-activities-modal 
          *ngIf="showActivitiesModal"
          [allIncomes]="allIncomes"
          [allExpenses]="allExpenses"
          (closeModal)="closeActivitiesModal()">
        </app-activities-modal>
      </div>
    </div>
  </div>
</div>